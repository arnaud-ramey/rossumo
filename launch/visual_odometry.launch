<launch>
<arg name="robot" default="rossumo1" />
<group ns="$(arg robot)">
  <!--
  Camera calibration:
  http://wiki.ros.org/camera_calibration/Tutorials/MonocularCalibration
  http://wiki.ros.org/camera_calibration
  $ rosrun camera_calibration cameracalibrator.py --size 8x10 --square 0.0298 image:=/rossumo1/rgb camera:=/camera
  Output: cf data/calibrationdata.tar.gz/ost.txt

  To record a bag from RGB video stream:
  $ rosbag record /rossumo1/cmd_vel /rossumo1/rgb

  Conversion bag ==> jpg files
  http://wiki.ros.org/rosbag/Tutorials/Exporting%20image%20and%20video%20data#Exporting_jpegs_from_bag_file
  -->
<!--
  <node pkg="rosbag" type="play" name="rosbag"
    args="/home/arnaud/sumo/bags/easy_circles.bag -d 2"/>
  <node name="extract" pkg="image_view" type="extract_images" respawn="false" output="screen" cwd="ROS_HOME">
    <param name="sec_per_frame" value="0.01"/>
    <remap from="image" to="rgb"/>
  </node>
-->

<!--
$ git clone https://github.com/srv/srv_tools.git
-->
  <remap from="camera/image_color" to="rgb"/>
  <remap from="camera/camera_info" to="camera_info"/>
  <node name="img_pub" pkg="bag_tools" type="image_sequence_publisher.py" output="screen" respawn="true">
    <param name="image_dir" value="/home/arnaud/sumo/bags"/>
    <param name="file_pattern" value="*.jpg"/>
    <param name="camera_info_file" value="/home/arnaud/catkin_ws/src/rossumo/data/sumo_camera_parameters.yaml"/>
    <param name="frequency" value="15"/>
  </node>

  <!-- http://wiki.ros.org/tf -->
  <node pkg="tf" type="static_transform_publisher" name="link1_broadcaster"
        args=".03 0 -.03  -1.57 0 -1.57 /base_link /camera 100" />

  <!--
  http://wiki.ros.org/viso2_ros
  https://github.com/srv/viso2/blob/ad3c24aacfef572f6f8a142cb7e4ad33db2a3811/viso2_ros/src/mono_odometer.cpp
  $ git clone https://github.com/srv/viso2.git
   -->
  <remap from="image" to="camera/image_color"/>
  <node pkg="viso2_ros" type="mono_odometer" name="mono_odometer" output="screen">
  <!-- Height of the camera above the ground in meters. -->
<!--
  <param name="camera_height" value=".055"/>
-->
  <param name="camera_height" value="0.01"/>
  <!-- Pitch of the camera in radiants, negative pitch means looking downwards. -->
  <param name="camera_pitch" value="-1"/>
  </node>
</group>
</launch>
